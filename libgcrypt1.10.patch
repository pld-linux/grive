--- grive-27817e835fe115ebbda5410ec904aa49a2ad01f1/cmake/Modules/FindLibGcrypt.cmake.orig	2013-05-02 18:40:04.000000000 +0200
+++ grive-27817e835fe115ebbda5410ec904aa49a2ad01f1/cmake/Modules/FindLibGcrypt.cmake	2024-08-12 14:38:00.878491532 +0200
@@ -34,6 +34,22 @@
   IF(LIBGCRYPT_LIBRARIES AND LIBGCRYPT_CFLAGS)
     SET(LIBGCRYPT_FOUND TRUE)
   ENDIF(LIBGCRYPT_LIBRARIES AND LIBGCRYPT_CFLAGS)
+ELSE(LIBGCRYPTCONFIG_EXECUTABLE)
+  FIND_PROGRAM(GPGRTCONFIG_EXECUTABLE NAMES gpgrt-config)
+  IF(GPGRTCONFIG_EXECUTABLE)
+  
+    EXEC_PROGRAM(${GPGRTCONFIG_EXECUTABLE} ARGS libgcrypt --libs RETURN_VALUE _return_VALUE OUTPUT_VARIABLE LIBGCRYPT_LIBRARIES)
+    
+    EXEC_PROGRAM(${GPGRTCONFIG_EXECUTABLE} ARGS libgcrypt --cflags RETURN_VALUE _return_VALUE OUTPUT_VARIABLE LIBGCRYPT_CFLAGS)
+    
+    IF(${LIBGCRYPT_CFLAGS} MATCHES "\n")
+      SET(LIBGCRYPT_CFLAGS " ")
+    ENDIF(${LIBGCRYPT_CFLAGS} MATCHES "\n")
+    
+    IF(LIBGCRYPT_LIBRARIES AND LIBGCRYPT_CFLAGS)
+      SET(LIBGCRYPT_FOUND TRUE)
+    ENDIF(LIBGCRYPT_LIBRARIES AND LIBGCRYPT_CFLAGS)
+  ENDIF(GPGRTCONFIG_EXECUTABLE)
 
 ENDIF(LIBGCRYPTCONFIG_EXECUTABLE)
 
